<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>隆莱英语学习助手</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff9800;
            --light-color: #f5f7fa;
            --dark-color: #333;
            --danger-color: #e74c3c;
            --success-color: #2ecc71;
            --border-radius: 8px;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background-color: #f0f2f5;
            color: var(--dark-color);
            line-height: 1.6;
            padding: 0;
            margin: 0;
        }

        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 16px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 4px;
        }

        .header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        .tab-bar {
            display: flex;
            background-color: white;
            border-bottom: 1px solid #ddd;
            position: sticky;
            top: 70px;
            z-index: 99;
        }

        .tab-btn {
            flex: 1;
            padding: 14px 10px;
            background: none;
            border: none;
            font-size: 1rem;
            color: #666;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-btn i {
            font-size: 1.1rem;
        }

        .tab-btn.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            font-weight: 600;
        }

        .content {
            padding: 16px;
            min-height: calc(100vh - 130px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: #555;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 1rem;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            text-align: center;
        }

        .btn:hover {
            background-color: var(--secondary-color);
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn-accent {
            background-color: var(--accent-color);
        }

        .btn-accent:hover {
            background-color: #e68900;
        }

        .btn-danger {
            background-color: var(--danger-color);
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-success {
            background-color: var(--success-color);
        }

        .btn-success:hover {
            background-color: #27ae60;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .btn-icon {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .word-list {
            list-style: none;
        }

        .word-item {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .word-item.favorite {
            border-left-color: var(--accent-color);
            background-color: #fffaf0;
        }

        .word-info {
            flex: 1;
            min-width: 200px;
        }

        .word-english {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--dark-color);
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .word-chinese {
            font-size: 1rem;
            color: #666;
            margin-bottom: 8px;
        }

        .word-category {
            display: inline-block;
            background-color: #eef2f7;
            color: var(--primary-color);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .word-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .favorite-btn {
            color: #ccc;
        }

        .favorite-btn.active {
            color: var(--accent-color);
        }

        .practice-btn {
            background-color: var(--success-color);
            color: white;
            padding: 8px 16px;
            border-radius: var(--border-radius);
            text-decoration: none;
            display: inline-block;
            margin-top: 16px;
            font-weight: 500;
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .category-btn {
            padding: 8px 16px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .category-btn.active {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .practice-card {
            text-align: center;
            padding: 30px 20px;
        }

        .practice-english {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .practice-chinese {
            font-size: 1.3rem;
            color: #666;
            margin-bottom: 30px;
        }

        .practice-controls {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 20px;
        }

        .hidden {
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            text-align: center;
        }

        .stat-item {
            flex: 1;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        @media (max-width: 480px) {
            .header {
                padding: 10px 14px;
            }
            
            .header h1 {
                font-size: 1.2rem;
            }
            
            .tab-btn {
                padding: 12px 6px;
                font-size: 0.9rem;
            }
            
            .content {
                padding: 12px;
            }
            
            .word-item {
                padding: 14px;
            }
            
            .word-actions {
                margin-top: 10px;
                width: 100%;
                justify-content: flex-end;
            }
            
            .practice-controls {
                flex-wrap: wrap;
            }
        }

        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--success-color);
            color: white;
            padding: 12px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .speech-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin: 20px 0;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading i {
            font-size: 2rem;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>隆莱英语学习助手</h1>
        <p>学习专业术语发音</p>
    </div>

    <div class="tab-bar">
        <button class="tab-btn active" data-tab="list">
            <i class="fas fa-list"></i>
            <span>列表</span>
        </button>
        <button class="tab-btn" data-tab="practice">
            <i class="fas fa-book-open"></i>
            <span>学习</span>
        </button>
        <button class="tab-btn" data-tab="favorites">
            <i class="fas fa-star"></i>
            <span>收藏</span>
        </button>
    </div>

    <div class="content">
        <!-- 单词列表界面 -->
        <div id="list" class="tab-content active">
            <div class="card">
                <h2 style="margin-bottom: 16px;">单词列表</h2>
                <div id="category-filter" class="category-filter">
                    <button class="category-btn active" data-category="all">全部</button>
                </div>
                <div id="word-list-container">
                    <div id="loading-words" class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>正在加载单词数据...</p>
                    </div>
                    <ul id="word-list" class="word-list hidden">
                        <!-- 单词项将通过JavaScript动态添加 -->
                    </ul>
                </div>
                <div id="empty-list" class="empty-state hidden">
                    <i class="fas fa-book"></i>
                    <h3>没有找到单词数据</h3>
                    <p>请检查JSON文件路径是否正确</p>
                </div>
            </div>
        </div>

        <!-- 学习界面 -->
        <div id="practice" class="tab-content">
            <div class="card practice-card">
                <h2 style="margin-bottom: 24px;">单词练习</h2>
                <div id="practice-category-select" class="form-group">
                    <label for="practice-category">选择分类练习</label>
                    <select id="practice-category" class="form-control">
                        <option value="all">全部单词</option>
                    </select>
                    <button id="start-practice" class="btn btn-block btn-accent" style="margin-top: 16px;">
                        开始练习
                    </button>
                </div>
                
                <div id="practice-area" class="hidden">
                    <div id="practice-word" class="practice-english"></div>
                    <div id="practice-meaning" class="practice-chinese"></div>
                    <div id="practice-pronunciation" style="color: #888; margin-bottom: 20px;"></div>
                    
                    <div class="speech-controls">
                        <button id="speak-english" class="btn">
                            <i class="fas fa-volume-up"></i> 朗读英文
                        </button>
                        <button id="speak-chinese" class="btn">
                            <i class="fas fa-volume-up"></i> 朗读中文
                        </button>
                    </div>
                    
                    <div class="practice-controls">
                        <button id="prev-word" class="btn">
                            <i class="fas fa-arrow-left"></i> 上一个
                        </button>
                        <button id="show-answer" class="btn btn-accent">
                            显示答案
                        </button>
                        <button id="next-word" class="btn">
                            下一个 <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <button id="end-practice" class="btn btn-danger">
                            <i class="fas fa-stop-circle"></i> 结束练习
                        </button>
                    </div>
                </div>
                
                <div id="practice-stats" class="stats hidden">
                    <div class="stat-item">
                        <div class="stat-value" id="total-practiced">0</div>
                        <div class="stat-label">已练习</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="total-words">0</div>
                        <div class="stat-label">总单词</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="favorite-count">0</div>
                        <div class="stat-label">已收藏</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 收藏夹界面 -->
        <div id="favorites" class="tab-content">
            <div class="card">
                <h2 style="margin-bottom: 16px;">收藏夹</h2>
                <div id="favorite-list-container">
                    <div id="loading-favorites" class="loading hidden">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>正在加载收藏数据...</p>
                    </div>
                    <ul id="favorite-list" class="word-list">
                        <!-- 收藏的单词项将通过JavaScript动态添加 -->
                    </ul>
                </div>
                <div id="empty-favorites" class="empty-state hidden">
                    <i class="fas fa-star"></i>
                    <h3>还没有收藏单词</h3>
                    <p>在单词列表中点击星形图标收藏单词</p>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification">
        操作成功！
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // 单词数据库
        let wordDatabase = {
            words: [],
            categories: []
        };
        
        // 当前练习状态
        let practiceState = {
            active: false,
            currentIndex: 0,
            currentWords: [],
            showAnswer: false
        };
        
        // JSON文件路径 - 根据您的实际路径修改
        const WORDS_JSON_PATH = "statics/info/words.json";
        
        // 初始化应用
        $(document).ready(function() {
            // 加载JSON数据
            loadWordsFromJSON();
            
            // 设置标签页切换
            setupTabs();
            
            // 设置练习功能
            $("#start-practice").click(startPractice);
            $("#end-practice").click(endPractice);
            $("#prev-word").click(prevWord);
            $("#next-word").click(nextWord);
            $("#show-answer").click(toggleAnswer);
            $("#speak-english").click(speakEnglish);
            $("#speak-chinese").click(speakChinese);
        });
        
        // 从JSON文件加载单词数据
        function loadWordsFromJSON() {
            $.ajax({
                url: WORDS_JSON_PATH,
                dataType: "json",
                success: function(data) {
                    // 隐藏加载提示
                    $("#loading-words").addClass("hidden");
                    
                    if (data && data.words && Array.isArray(data.words)) {
                        wordDatabase = data;
                        
                        // 如果没有categories字段，从单词中提取
                        if (!wordDatabase.categories || wordDatabase.categories.length === 0) {
                            extractCategoriesFromWords();
                        }
                        
                        // 更新UI
                        updateCategoryList();
                        renderWordList();
                        updatePracticeStats();
                        
                        showNotification("单词数据加载成功");
                    } else {
                        $("#empty-list").removeClass("hidden");
                        showNotification("JSON数据格式不正确", "danger");
                    }
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error("加载JSON文件失败:", textStatus, errorThrown);
                    
                    // 隐藏加载提示
                    $("#loading-words").addClass("hidden");
                    $("#empty-list").removeClass("hidden");
                    
                    showNotification("无法加载单词数据，请检查JSON文件路径", "danger");
                }
            });
        }
        
        // 从单词中提取分类
        function extractCategoriesFromWords() {
            const categories = [];
            wordDatabase.words.forEach(word => {
                if (word.category && !categories.includes(word.category)) {
                    categories.push(word.category);
                }
            });
            wordDatabase.categories = categories;
        }
        
        // 保存收藏状态到本地存储
        function saveFavoritesToLocalStorage() {
            const favorites = {};
            wordDatabase.words.forEach(word => {
                if (word.favorite) {
                    favorites[word.id] = true;
                }
            });
            localStorage.setItem("englishLearningFavorites", JSON.stringify(favorites));
        }
        
        // 从本地存储加载收藏状态
        function loadFavoritesFromLocalStorage() {
            const favoritesJson = localStorage.getItem("englishLearningFavorites");
            if (favoritesJson) {
                try {
                    const favorites = JSON.parse(favoritesJson);
                    wordDatabase.words.forEach(word => {
                        word.favorite = !!favorites[word.id];
                    });
                } catch (e) {
                    console.error("解析收藏数据失败:", e);
                }
            }
        }
        
        // 标签页切换
        function setupTabs() {
            $(".tab-btn").click(function() {
                const tabId = $(this).data("tab");
                
                // 更新活动标签按钮
                $(".tab-btn").removeClass("active");
                $(this).addClass("active");
                
                // 显示对应内容
                $(".tab-content").removeClass("active");
                $("#" + tabId).addClass("active");
                
                // 刷新列表显示
                if (tabId === "list") {
                    renderWordList();
                } else if (tabId === "favorites") {
                    renderFavoritesList();
                }
            });
        }
        
        // 更新分类列表显示
        function updateCategoryList() {
            // 更新列表界面的分类筛选器
            const categoryFilter = $("#category-filter");
            categoryFilter.html('<button class="category-btn active" data-category="all">全部</button>');
            
            wordDatabase.categories.forEach(category => {
                const button = $("<button>")
                    .addClass("category-btn")
                    .attr("data-category", category)
                    .text(category);
                categoryFilter.append(button);
            });
            
            // 添加分类筛选事件
            $("#category-filter .category-btn").click(function() {
                $("#category-filter .category-btn").removeClass("active");
                $(this).addClass("active");
                
                const selectedCategory = $(this).data("category");
                renderWordList(selectedCategory);
            });
            
            // 更新练习界面的分类选择
            const practiceCategorySelect = $("#practice-category");
            practiceCategorySelect.html('<option value="all">全部单词</option>');
            
            wordDatabase.categories.forEach(category => {
                const option = $("<option>")
                    .val(category)
                    .text(category);
                practiceCategorySelect.append(option);
            });
        }
        
        // 渲染单词列表
        function renderWordList(category = "all") {
            const wordListElement = $("#word-list");
            const emptyListElement = $("#empty-list");
            
            wordListElement.empty();
            
            // 筛选单词
            let filteredWords = wordDatabase.words;
            if (category !== "all") {
                filteredWords = wordDatabase.words.filter(word => word.category === category);
            }
            
            if (filteredWords.length === 0) {
                wordListElement.addClass("hidden");
                emptyListElement.removeClass("hidden");
                return;
            }
            
            wordListElement.removeClass("hidden");
            emptyListElement.addClass("hidden");
            
            // 渲染每个单词
            filteredWords.forEach(word => {
                const wordItem = $("<li>")
                    .addClass(`word-item ${word.favorite ? "favorite" : ""}`)
                    .attr("data-id", word.id);
                
                const wordHtml = `
                    <div class="word-info">
                        <div class="word-english">
                            ${word.english}
                            <button class="btn-icon speak-word-btn" title="朗读">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <div class="word-chinese">${word.chinese}</div>
                        <span class="word-category">${word.category}</span>
                    </div>
                    <div class="word-actions">
                        <button class="btn-icon favorite-btn ${word.favorite ? "active" : ""}" title="${word.favorite ? "取消收藏" : "收藏"}">
                            <i class="fas ${word.favorite ? "fa-star" : "fa-star"}"></i>
                        </button>
                        <button class="btn-icon practice-single-btn" title="学习此单词">
                            <i class="fas fa-book-open"></i>
                        </button>
                    </div>
                `;
                
                wordItem.html(wordHtml);
                wordListElement.append(wordItem);
            });
            
            // 添加事件监听器
            addWordItemListeners();
        }
        
        // 添加单词项的事件监听器
        function addWordItemListeners() {
            // 收藏按钮
            $(".favorite-btn").click(function() {
                const wordItem = $(this).closest(".word-item");
                const wordId = wordItem.data("id");
                
                toggleFavorite(wordId);
            });
            
            // 朗读按钮
            $(".speak-word-btn").click(function() {
                const wordItem = $(this).closest(".word-item");
                const wordId = wordItem.data("id");
                const word = wordDatabase.words.find(w => w.id === wordId);
                
                if (word) {
                    speakText(word.english, "en-US");
                }
            });
            
            // 单个单词学习按钮
            $(".practice-single-btn").click(function() {
                const wordItem = $(this).closest(".word-item");
                const wordId = wordItem.data("id");
                const word = wordDatabase.words.find(w => w.id === wordId);
                
                if (word) {
                    // 切换到学习界面
                    $(".tab-btn").removeClass("active");
                    $(".tab-btn[data-tab='practice']").addClass("active");
                    
                    $(".tab-content").removeClass("active");
                    $("#practice").addClass("active");
                    
                    // 直接学习这个单词
                    practiceSingleWord(word);
                }
            });
        }
        
        // 渲染收藏列表
        function renderFavoritesList() {
            const favoriteListElement = $("#favorite-list");
            const emptyFavoritesElement = $("#empty-favorites");
            
            favoriteListElement.empty();
            
            // 筛选收藏的单词
            const favoriteWords = wordDatabase.words.filter(word => word.favorite);
            
            if (favoriteWords.length === 0) {
                favoriteListElement.addClass("hidden");
                emptyFavoritesElement.removeClass("hidden");
                return;
            }
            
            favoriteListElement.removeClass("hidden");
            emptyFavoritesElement.addClass("hidden");
            
            // 渲染每个收藏的单词
            favoriteWords.forEach(word => {
                const wordItem = $("<li>")
                    .addClass("word-item favorite")
                    .attr("data-id", word.id);
                
                const wordHtml = `
                    <div class="word-info">
                        <div class="word-english">
                            ${word.english}
                            <button class="btn-icon speak-word-btn" title="朗读">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                        <div class="word-chinese">${word.chinese}</div>
                        <span class="word-category">${word.category}</span>
                    </div>
                    <div class="word-actions">
                        <button class="btn-icon favorite-btn active" title="取消收藏">
                            <i class="fas fa-star"></i>
                        </button>
                        <button class="btn-icon practice-single-btn" title="学习此单词">
                            <i class="fas fa-book-open"></i>
                        </button>
                    </div>
                `;
                
                wordItem.html(wordHtml);
                favoriteListElement.append(wordItem);
            });
            
            // 添加事件监听器
            addWordItemListeners();
        }
        
        // 切换收藏状态
        function toggleFavorite(wordId) {
            const word = wordDatabase.words.find(word => word.id === wordId);
            
            if (word) {
                word.favorite = !word.favorite;
                saveFavoritesToLocalStorage();
                
                // 重新渲染列表
                renderWordList();
                renderFavoritesList();
                updatePracticeStats();
                
                showNotification(word.favorite ? "已添加到收藏夹" : "已从收藏夹移除");
            }
        }
        
        // 更新练习统计
        function updatePracticeStats() {
            $("#total-words").text(wordDatabase.words.length);
            $("#favorite-count").text(wordDatabase.words.filter(word => word.favorite).length);
            
            if (practiceState.active) {
                $("#total-practiced").text(practiceState.currentIndex + 1);
            }
        }
        
        // 开始练习
        function startPractice() {
            const selectedCategory = $("#practice-category").val();
            
            // 筛选单词
            let practiceWords = wordDatabase.words;
            if (selectedCategory !== "all") {
                practiceWords = wordDatabase.words.filter(word => word.category === selectedCategory);
            }
            
            if (practiceWords.length === 0) {
                showNotification("没有找到单词，请选择其他分类", "danger");
                return;
            }
            
            // 打乱顺序
            practiceWords = shuffleArray([...practiceWords]);
            
            // 设置练习状态
            practiceState = {
                active: true,
                currentIndex: 0,
                currentWords: practiceWords,
                showAnswer: false
            };
            
            // 切换界面
            $("#practice-category-select").addClass("hidden");
            $("#practice-area").removeClass("hidden");
            $("#practice-stats").removeClass("hidden");
            
            // 显示第一个单词
            displayPracticeWord();
            updatePracticeStats();
        }
        
        // 结束练习
        function endPractice() {
            practiceState.active = false;
            
            // 切换界面
            $("#practice-category-select").removeClass("hidden");
            $("#practice-area").addClass("hidden");
            $("#practice-stats").addClass("hidden");
        }
        
        // 学习单个单词
        function practiceSingleWord(word) {
            // 设置练习状态为单个单词
            practiceState = {
                active: true,
                currentIndex: 0,
                currentWords: [word],
                showAnswer: true  // 直接显示答案
            };
            
            // 切换界面
            $("#practice-category-select").addClass("hidden");
            $("#practice-area").removeClass("hidden");
            $("#practice-stats").removeClass("hidden");
            
            // 显示单词
            displayPracticeWord();
            updatePracticeStats();
        }
        
        // 显示练习单词
        function displayPracticeWord() {
            if (!practiceState.active || practiceState.currentWords.length === 0) {
                return;
            }
            
            const currentWord = practiceState.currentWords[practiceState.currentIndex];
            const practiceWordElement = $("#practice-word");
            const practiceMeaningElement = $("#practice-meaning");
            const practicePronunciationElement = $("#practice-pronunciation");
            const showAnswerButton = $("#show-answer");
            
            practiceWordElement.text(currentWord.english);
            
            if (practiceState.showAnswer) {
                practiceMeaningElement.text(currentWord.chinese);
                practicePronunciationElement.text(currentWord.pronunciation || "");
                practiceMeaningElement.css("opacity", "1");
                practicePronunciationElement.css("opacity", "1");
                showAnswerButton.text("隐藏答案");
            } else {
                practiceMeaningElement.text("点击'显示答案'查看中文意思");
                practicePronunciationElement.text("");
                practiceMeaningElement.css("opacity", "0.5");
                showAnswerButton.text("显示答案");
            }
            
            // 更新按钮状态
            $("#prev-word").prop("disabled", practiceState.currentIndex === 0);
            $("#next-word").prop("disabled", practiceState.currentIndex === practiceState.currentWords.length - 1);
            
            updatePracticeStats();
        }
        
        // 上一个单词
        function prevWord() {
            if (practiceState.currentIndex > 0) {
                practiceState.currentIndex--;
                practiceState.showAnswer = false;
                displayPracticeWord();
            }
        }
        
        // 下一个单词
        function nextWord() {
            if (practiceState.currentIndex < practiceState.currentWords.length - 1) {
                practiceState.currentIndex++;
                practiceState.showAnswer = false;
                displayPracticeWord();
            }
        }
        
        // 显示/隐藏答案
        function toggleAnswer() {
            practiceState.showAnswer = !practiceState.showAnswer;
            displayPracticeWord();
        }
        
        // 朗读英文
        function speakEnglish() {
            if (!practiceState.active || practiceState.currentWords.length === 0) return;
            
            const currentWord = practiceState.currentWords[practiceState.currentIndex];
            speakText(currentWord.english, "en-US");
        }
        
        // 朗读中文
        function speakChinese() {
            if (!practiceState.active || practiceState.currentWords.length === 0) return;
            
            const currentWord = practiceState.currentWords[practiceState.currentIndex];
            speakText(currentWord.chinese, "zh-CN");
        }
        
        // 文本转语音
        function speakText(text, lang) {
            if ("speechSynthesis" in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = lang;
                utterance.rate = 0.8;
                window.speechSynthesis.speak(utterance);
            } else {
                showNotification("您的浏览器不支持语音合成功能", "danger");
            }
        }
        
        // 显示通知
        function showNotification(message, type = "success") {
            const notification = $("#notification");
            notification.text(message);
            
            // 设置颜色
            if (type === "danger") {
                notification.css("backgroundColor", "var(--danger-color)");
            } else if (type === "warning") {
                notification.css("backgroundColor", "var(--accent-color)");
            } else {
                notification.css("backgroundColor", "var(--success-color)");
            }
            
            notification.addClass("show");
            
            setTimeout(() => {
                notification.removeClass("show");
            }, 3000);
        }
        
        // 辅助函数：打乱数组顺序
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }
        
        // 页面加载完成后加载收藏状态
        $(window).on("load", function() {
            loadFavoritesFromLocalStorage();
        });
    </script>
</body>

</html>
